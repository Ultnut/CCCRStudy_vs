## 클라우드 로드밸런싱


#### 역활

1) 부하분산을 통한 처리량 증가 및 응답시간 감서
2) 한대의 서버에 장애가 발생했을떄 장애가 없는 다른 서버로 트래픽 전달, 가용성 증대

- 구글 컴퓨터 엔진으로 생성한 VM 인스턴트들 앞에 로드 밸런서를 두어서 부하 분산
- L4 스위치 같이 tcp/udp 프로토콜을 라우팅 하고, HTTP/HTTPS 프로토콜에 대해서는 L7과 유사한 기능을 함

### GCP 로드밸런서 기능

1) 지역 수준의 부하분산이 가능하다. 클라이언트에서 가까운 지역으로 우선 라우팅하고, 그 지역에 장애가 발생시 알아서 다른 지역으로 라우팅해준다. 인스턴스 그룹을 여러지역에 배치하여 백엔드 구성시 지역 수준의 부하분산 가능
2) 프리웜업 : 로드밸런서에 갑자기 높은 부하가 들어오면 그것을 받아내지 못한다. 이를 방지하기 위해 일정 시간 간격으로 로드밸런서에게 높은 부하를 가하여 로드밸런서의 크기를 키움 -> 트래픽양에 맞춰 로드밸런서의 규모를 키움
3) 모든 트래픽 로깅 가능

![GCPLD](https://blog.pythian.com/wp-content/uploads/ProxySQL-behind-a-load-balancer-in-Google-Cloud.png)


4) 하나의 백앤드 서비스는 여러개의 백앤드를 가질수 있다. 백엔드는 GCP 로드밸런서가 분산시키는 실질적인 자원으로, 인스턴스 그룹 또는 앤드포인트그룹을 의미함. 

5) AUTO SCALING : 오토 스케일링 Auto Scaling
리소스 사용량에 따라서 VM이 자동으로 증가하고 감소하는 기능.

6) GCP에서는 인스턴스 그룹을 통해서 설정할 수 있음.
인스턴스 템블릿을 통해서 관리혀 인스턴스 그룹을 만들면 동종의 인스턴스들이 만들어지기 때문에 애플리케이션에서 트래픽 증가와 감소를 원활하게 처리할 수 있음,

7) LB설정 순서: 스냅샷 생성 -> 이미지 생성 -> 디스크 생성 -> 템플릿 생성 -> 인스턴스 그룹 생성 -> 로드밸런서 생성

## GCP SQL 연동방법 3가지
1. 외부 아이피를 사용하기
2. Proxy 사용
3. Virtual Private Cloud(VPC) 사용

### VPN (Virtual Private Network)
- Cloud와 On-Premise 간 VPN 접속을 통한 연결을 할수있도록 도와주는 사설
- VPC 네트워크는 연결된 라우터와 방화벽 규칙을 포함하여 전역 리소스다
- 특정 리전또는 영역과 연결되지 않음


### CDN (Content Delivery Network) 
![CDN](https://t1.daumcdn.net/cfile/tistory/992EE4355BFE64FA27)

- Google Compute Engine(GCE) 과 Google Cloud Storage(GCS) 를 기반으로 하는 웹사이트와 애플리케이션에 대한 콘텐츠 전송을 가속화 할 수 있는 기능을 제공. Cloud CDN 을 활용하게 되면 이미지와 같은 정적 컨텐츠에 대해서 네트워크 지연 시간을 줄이고 원본에 걸리는 부하를 분산하거나 제공 비용을 절감할 수 있다.










